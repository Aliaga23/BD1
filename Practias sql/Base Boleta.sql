CREATE DATABASE MAESTRO_DE_OFERTA;
USE MAESTRO_DE_OFERTA;

CREATE TABLE MATERIA
(
	SIGLA varchar(6) NOT NULL PRIMARY KEY,
    NOMBRE VARCHAR(60) NOT NULL
);

CREATE TABLE DOCENTE 
(
	CODIGO INTEGER NOT NULL PRIMARY KEY,
	NOMBRE VARCHAR(60) NOT NULL
);


CREATE TABLE PERIODO
(
	ID  INTEGER NOT NULL PRIMARY KEY,
    NUMERO  tinyint NOT NULL,
    AÑO  SMALLINT NOT NULL
);

CREATE TABLE GRUPO
(
	ID INTEGER NOT NULL PRIMARY KEY,
    NOMBRE VARCHAR(3) NOT NULL,
    
    IDDOCENTE INTEGER NOT NULL,
    foreign key (IDDOCENTE) references DOCENTE(CODIGO)
	ON UPDATE CASCADE
	ON DELETE CASCADE,
    
    SIGLAMAT varchar(6) NOT NULL,
    foreign key (SIGLAMAT) references MATERIA(SIGLA)
	ON UPDATE CASCADE
	ON DELETE CASCADE,
    
    IDPERIODO INTEGER NOT NULL,
    foreign key (IDPERIODO) references PERIODO(ID)
	ON UPDATE CASCADE
	ON DELETE CASCADE
);

CREATE TABLE HORARIO
(
	IDGRUPO INTEGER NOT NULL,
	ID tinyint NOT NULL,  -- ES PRIMARIA???????
    DIA VARCHAR(10) NOT NULL,
    HORAI time NOT NULL,
    HORAF time NOT NULL,
	PRIMARY KEY (IDGRUPO, ID),
	foreign key (IDGRUPO) references GRUPO(ID)
	ON UPDATE CASCADE
	ON DELETE CASCADE
);


CREATE TABLE INSCRIBE
(
	IDGRUPO INTEGER NOT NULL,
	NROBOLETA INTEGER NOT NULL,
	PRIMARY KEY(IDGRUPO, NROBOLETA),     
	foreign key (IDGRUPO) references GRUPO(ID)
	ON UPDATE CASCADE
	ON DELETE CASCADE,
	foreign key (NROBOLETA) references BOLETAINSCRIPCION(NRO)
	ON UPDATE CASCADE
	ON DELETE CASCADE
);

CREATE TABLE ALUMNO
(
	REGISTRO INTEGER NOT NULL PRIMARY KEY,
    NOMBRE VARCHAR(60) NOT NULL
);

CREATE TABLE BOLETAINSCRIPCION
(
	NRO INTEGER NOT NULL PRIMARY KEY,
    FECHA DATE NOT NULL,
    HORA time NOT NULL,
    
	REGISTROALUMNO INTEGER NOT NULL,
    foreign key (REGISTROALUMNO) references ALUMNO(REGISTRO)
	ON UPDATE CASCADE
	ON DELETE CASCADE
);



/* ------------------------------------INSERTAR VALORES -----------------------------------------*/

-- DOCENTE
	SELECT *
    FROM DOCENTE;
	INSERT INTO DOCENTE VALUES(100, 'VEIZAGA JOSUE');
	INSERT INTO DOCENTE VALUES(101, 'GARZON ANGELICA');
	INSERT INTO DOCENTE VALUES(102, 'VARGAS EDWIN');

-- MATERIA
	SELECT *
	FROM MATERIA;
	INSERT INTO MATERIA VALUES('INF110', 'INTRODUCCION A LA INFORMATICA');
	INSERT INTO MATERIA VALUES('INF312', 'BASE DE DATOS I');
	INSERT INTO MATERIA VALUES('INF120', 'PROGRAMACION I');

-- PERIODO
	SELECT *
	FROM PERIODO;
	INSERT INTO PERIODO VALUES(1, 2, 2021);
	INSERT INTO PERIODO VALUES(2, 1, 2022);
	INSERT INTO PERIODO VALUES(3, 2, 2022);
	

-- GRUPO
	SELECT *
	FROM GRUPO;
	INSERT INTO GRUPO VALUES(1, 'Z2', '101','INF110', '2');
	INSERT INTO GRUPO VALUES(2, 'SC', '100','INF312', '2');
	INSERT INTO GRUPO VALUES(3, 'SD', '102','INF120', '3');
	INSERT INTO GRUPO VALUES(4, 'SX', '102','INF120', '1'); -- 2021
    
    
-- HORARIO              REVISAR
	SELECT *
    FROM HORARIO;
    INSERT INTO HORARIO VALUES(1, 1, 'LUNES', '10:00', '11:30');
    INSERT INTO HORARIO VALUES(1, 2, 'MIERCOLES', '10:00', '11:30');
    INSERT INTO HORARIO VALUES(1, 3, 'VIERNES', '10:00', '11:30');
    --
    
    INSERT INTO HORARIO VALUES(2, 1, 'MARTES', '07:00', '9:15');
    INSERT INTO HORARIO VALUES(2, 2, 'JUEVES', '07:00', '9:15');
    
    --
      INSERT INTO HORARIO VALUES(3, 1, 'MARTES', '20:30', '22:45');
      INSERT INTO HORARIO VALUES(3, 2, 'JUEVES', '20:30', '22:45');
    --
    
      INSERT INTO HORARIO VALUES(4, 1, 'MIERCOLES', '20:30', '22:45');
      INSERT INTO HORARIO VALUES(4, 2, 'JUEVES', '20:30', '22:45');
      INSERT INTO HORARIO VALUES(4, 3, 'VIERNES', '20:30', '22:45');

	

-- INSCRIBE
	SELECT *
    FROM INSCRIBE;
	INSERT INTO INSCRIBE VALUES( 4 , 1000);
	INSERT INTO INSCRIBE VALUES( 1, 1001);
	INSERT INTO INSCRIBE VALUES( 2, 1001);
	INSERT INTO INSCRIBE VALUES( 3, 1002);
    

-- BOLETA DE INSCRIPCION
	SELECT *
    
    FROM BOLETAINSCRIPCION;
	INSERT INTO BOLETAINSCRIPCION VALUES(1000, '2021/08/20', '13:15', 200);
    INSERT INTO BOLETAINSCRIPCION VALUES(1001, '2022/01/14', '10:40', 201);
    INSERT INTO BOLETAINSCRIPCION VALUES(1002, '2022/08/23', '10:40', 202);


-- ALUMNO 
	SELECT *
    FROM ALUMNO;
    INSERT INTO ALUMNO VALUES(200, 'JOAQUIN CHUMACERO'); 
    INSERT INTO ALUMNO VALUES(201, 'FABIOLA MENDEZ');
    
    INSERT INTO ALUMNO VALUES(202, 'SATURNINO MAMANI');


/* ---------------------- METODOS -----------------------------------*/
-- Mostrar el nombre de los docentes que han sido programado el semestre/
SELECT DOCENTE.NOMBRE
FROM DOCENTE, GRUPO, PERIODO
WHERE DOCENTE.CODIGO = GRUPO.IDDOCENTE AND PERIODO.ID = GRUPO.IDPERIODO 
AND IDPERIODO = 3;


-- Mostrar el nombre de los docentes que enseñan la materia de/
SELECT DOCENTE.NOMBRE
FROM DOCENTE, GRUPO, MATERIA
WHERE DOCENTE.CODIGO = GRUPO.IDDOCENTE AND MATERIA.SIGLA = GRUPO.SIGLAMAT
AND MATERIA.NOMBRE = 'INTRODUCCION A LA INFORMATICA';